---
title: Piecewise Constant Hamiltonian
date: 2024-02-15
authors:
  - name: Akinori Machino
---

# 区分定数ハミルトニアン

系のハミルトニアンが、時間に依存するが、時間によって区分的に定数であるとする。

$$
H(t) = H_n \quad (t_{n-1} \le t \le t_{n})
$$
$$
n = 1, 2, \dots
$$

つまり、時間 $t$ が $t_0 \le t \le t_1$ の間は $H_1$ 、$t_1 \le t \le t_2$ の間は $H_2$ 、というように、時間経過とともにハミルトニアンが階段状に変化する状況を考える。

$\Delta t_n = t_n - t_{n-1}$ とすると、時間発展演算子 $U(t_n, t_{n-1})$ は

$$
U(t_n, t_{n-1}) = e^{-i H_n \Delta t_n}
$$

であるので、時間 $t_0$ から $t_n$ までの時間発展演算子 $U(t_n, t_0)$ は

$$
\begin{aligned}
U(t_n, t_0) &= U(t_n, t_{n-1}) U(t_{n-1}, t_{n-2}) \cdots U(t_1, t_0)
\\
&= e^{-i H_n \Delta t_n} e^{-i H_{n-1} \Delta t_{n-1}} \cdots e^{-i H_1 \Delta t_1}
\end{aligned}
$$

と表される。

$\{H_n\}$ の要素がすべて交換する場合には、

$$
\begin{aligned}
U(t_n, t_0) &= e^{-i H_n \Delta t_n} e^{-i H_{n-1} \Delta t_{n-1}} \cdots e^{-i H_1 \Delta t_1}
\\
&= e^{-i \left( H_n \Delta t_n + H_{n-1} \Delta t_{n-1} + \cdots + H_1 \Delta t_1 \right)}
\end{aligned}
$$

とできるが、一般には交換しないことに注意する。

すべて交換する具体的な例としては、量子ビットを $I$ 成分のみ（$x$軸回転のみ）の制御パルス

$$
H(t) = \frac{I(t)}{2} \sigma_x
$$
$$
I(t) = I_n \quad (t_{n-1} \le t \le t_{n})
$$

で操作する場合が挙げられる。

一方、 $I/Q$ 両成分を含むパルスを用いる場合

$$
H(t) = \frac{I(t)}{2} \sigma_x + \frac{Q(t)}{2} \sigma_y
$$

には、$\sigma_x$ と $\sigma_y$ が交換しないため、指数の肩をまとめることはできない。

ただし、いずれの場合においても、区分定数ハミルトニアンの時間発展 $U(t_n, t_0)$ は、微分方程式（シュレーディンガー方程式）の $dt$ を細かく刻んで数値的に追う必要はなく、高々 $n$ 回の行列指数と行列積の計算で厳密に求めることができる [^1]。

[^1]: 行列指数計算は高コストだと思うが、区分定数ハミルトニアンの場合には、各区間での行列指数計算を独立に行うことができるため、並列化できそうだ。

単一軸回転の量子制御シミュレーションに至っては、1回の行列指数計算で済むため、非常に効率的に行える。

複数量子ビット結合系の量子制御においても、系のハミルトニアンが静的であれば、区分定数ハミルトニアンとして取り扱うことができる。具体的には、制御パルスの座標系に乗ることで、パルス波形（エンベロープの $I/Q$ 配列）による区分定数ハミルトニアンとして取り扱うことができる。

ただし、同時に複数量子ビットを制御する場合には、量子ビット間の共鳴周波数差 $\Delta = \omega_i - \omega_j$ に由来する時間依存性が生じるため、$I/Q$ 配列の区分定数ハミルトニアンとして取り扱うことはできない。その場合、 $e^{i \Delta t}$ を十分に分解できる粒度でサンプリングする必要がある ^[2] 。

[^2]: サンプリング定理（ナイキスト定理）によれば、 $dt$ が $\frac{1}{2\Delta}$ より小さければ、十分に分解できるはず。